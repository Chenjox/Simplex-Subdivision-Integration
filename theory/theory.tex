% !TeX root: .\Beleg5.tex
% arara: clean: { files: [theory.log,theory.aux,theory.thm,theory.slnc] }
% arara: pdflatex
% arara: pdflatex
% arara: pdflatex
\documentclass{mitschrift}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[ngerman]{babel}

%\usepackage{isodate}
\usepackage{graphicx}
\usepackage{tikz}

\newcommand{\R}{\mathbb{R}}
\newcommand{\Bary}{\mathbb{B}}

\doctitel{Simplex Integration}
\docuntertitel{By Domain Subdivision}

\tikzset{
  engineering axonometry/.style={x={(222:0.5cm)}, y={(-7:1cm)}, z={(90:1cm)}}
}
\newcommand{\simplex}{\boldsymbol{\Delta}}

\begin{document}
\makekopf

\tableofcontents

\pagebreak

\part{Theory}

\section{Problem}

Total Energy in the System: \begin{equation}
    \Pi = \int_\Omega g(\phi) \psi(\boldsymbol{u}) \diff \Omega + \frac{G_c}{2l} \int_\Omega \phi^2 + l^2 \nabla \phi \cdot \nabla \phi \diff \Omega \abbild \min
\end{equation} 

Degradation Function \begin{equation}
    g(\phi) = \left(1 - \phi^2\right) + k
\end{equation} mit \begin{conditions}
    k  & being a small but finite scalar such as $\num{10e-6}$ \\
    G_c & critical energy release rate, material parameter \\
    l  & \emph{width} of phase field \\
\psi (u) & strain energy density function\\
    u & displacement function \\
    \phi & phase field parameter, ansatz function discussed below \\
    \nabla \phi & gradient of phase field parameter \\
\end{conditions}

\begin{equation}
    \vdiff_u \Pi = \int_\Omega g(\phi) \sigma(\boldsymbol{u}) \pardiff{\varepsilon}{\boldsymbol{u}} \vdiff \boldsymbol{u} = 0
\end{equation}

\begin{equation}
    \vdiff_\phi \Pi = \int_\Omega 2(\phi - 1) \vdiff\phi \psi(\boldsymbol{u}) \diff \Omega + \frac{G_c}{l} \int_\Omega \phi \vdiff \phi + l^2 \nabla \phi \cdot \nabla \vdiff \phi \diff \Omega = 0
\end{equation}

\subsection{Ansatz functions}

\begin{equation}
    \boldsymbol{u} = \sum_i N_i \boldsymbol{u}_i + \sum_i N_i F \boldsymbol{a}_i 
\end{equation} mit \begin{conditions}
    N_i & are quadratic lagrange (standard) shape functions for tetrahedrons \\
    \boldsymbol{U}_i = \boldsymbol{u}_i, \boldsymbol{a}_i & are nodal degrees of freedom for displacement function \\
    F & is an enrichment function (sigmoid like, depends on $\phi$, later) \\
\end{conditions}

\begin{equation}
    f_{\text{base}} = \sum_i N_i \phi_i
\end{equation}

\begin{equation}
    \varsigmait = \frac{f_{\text{base}}}{\sqrt[4]{f_{\text{base}}^2 + k_{\text{res}}}}
\end{equation} mit \begin{conditions}
k_\text{reg} & small but finite parameter \\
\end{conditions}

\begin{align}
    \phi &= \exp(-\varsigmait) \\
    \phi &= \exp(-\frac{\varsigmait}{l})
\end{align}

we need to be able to integrate the residual vectors and the stiffness matrices
efficiently and accurately
\begin{equation}
    \vdiff_{\boldsymbol{U}_i} \Pi = \int_\Omega g(\phi)\boldsymbol{\sigma}(\boldsymbol{u})\pardiff{\varepsilon}{\boldsymbol{u}}\cdot \pardiff{\boldsymbol{u}}{\boldsymbol{U}} \diff \Omega \cdot \vdiff \boldsymbol{U}_i
\end{equation}

\begin{equation}
    \vdiff_{\phi_i} \Pi = \int_\Omega 2(\phi - 1) \pardiff{\phi}{\phi_i} \psi(\boldsymbol{u}) \diff \Omega \vdiff\phi_i + \frac{G_c}{l} \int_\Omega \phi \pardiff{\phi}{\phi_i} + l^2 \nabla \phi \cdot \pardiff{\nabla \phi}{\phi_i} \diff \Omega \vdiff \phi_i = 0
\end{equation}

\begin{equation}
    \Delta_{U_i} \vdiff_{U_i} \Pi = U_i \cdot \int_\Omega g(\phi) \pardiff{\varepsilon}{U_i}\cdot \mathbb{C}\cdot \pardiff{\varepsilon}{U_i} \diff \Omega \cdot \vdiff U_i 
\end{equation}

\begin{align}
    \Delta_{\phi_j} \vdiff_{\phi_i} \Pi &= \phi_j \int_\Omega 2\left(\pardiff{\phi}{\phi_i}\right)^2 \psi(u) \diff \Omega \vdiff \phi_i 
    + \phi_j \int_\Omega 2(\phi -1 )\pardiff[^2]{\phi}{\phi_i^2} \psi(u) \diff \Omega \vdiff \phi_i \\
&\phantom{={}} +\phi_j \frac{G_c}{l} \int_\Omega \pardiff{\phi}{\phi_i} + \pardiff[^2]{\phi}{\phi_i} + l^2 \pardiff{\nabla \phi}{\phi_j} \cdot \pardiff{\nabla \phi}{\phi_i} + l^2 \nabla \phi \cdot \pardiff[^2]{\nabla \phi}{\phi_i^2} \diff \Omega \vdiff \phi_i
\end{align}

\subsection{Numerical Work}

\begin{align} % https://www.desmos.com/calculator/ibitgx2dws
    \pardiff{\phi}{\phi_i} &= - \frac{1}{l}\phi \pardiff{\varsigmait}{f_{\text{base}}} N_i \\
    \pardiff{\varsigmait}{f_{\text{base}}} &= \biggl(1 - \frac{f_{\text{base}}^2}{2\bigl(f_{\text{base}}^2 + k_{\text{res}}\bigr)}\biggr) \cdot \frac{1}{\sqrt[4]{f_{\text{base}}^2 + k_{\text{res}}}}\\
    \pardiff[^2]{\varsigmait}{f_{\text{base}}^2} &= \biggl(\frac{5f_{\text{base}}^3}{\bigl(f_{\text{base}}^2 + k_{\text{res}}\bigr)} - 6 f_{\text{base}}\biggr) \cdot \frac{1}{4 {\sqrt[4]{f_{\text{base}}^2 + k_{\text{res}}}}^5}\\
    \pardiff[^3]{\varsigmait}{f_{\text{base}}^3}&= \frac{3\left(-4k_{\text{res}}^{2}+12k_{\text{res}}f_{\text{base}}^{2}+f_{\text{base}}^{4}\right)}{2\left(f_{\text{base}}^{2}+k_{\text{res}}\right)^{2}}\cdot\frac{1}{4{\sqrt[4]{f_{\text{base}}^2 + k_{\text{res}}}}^5}\\
    \pardiff[^2]{\phi}{\phi_i^2} &= \frac{1}{l^2} \biggl( \biggl(\pardiff{\varsigmait}{f_{\text{base}}}\biggr)^2 - \pardiff[^2]{\varsigmait}{f_{\text{base}}^2} \biggr) N_i \cdot N_i
\end{align}



\pagebreak

\section{Simplex Integration in $n=2$}


First start with definitions:

\paragraph{Pure Integrator} is any quadrature formula of the simplex: \begin{equation}
    I = \iint_{\simplex} f(\xi_1, \xi_2, \xi_3) \diff \simplex \approx \sum_{i} w_i f(\xi_{1,i}, \xi_{2,i}, \xi_{3,i})
\end{equation} The Term \emph{pure} is used for telling them apart from subdivision integrators.

\paragraph{Subdivision Integrators} are Integrators of the form: \begin{equation}
    I = \iint_{\simplex} f(\xi_1, \xi_2, \xi_3) \diff \simplex = \sum_{i} \iint_{\simplex_i} f(\xi_1, \xi_2, \xi_3) \diff \simplex_i
\end{equation} which then will be evaluated by pure Integrators.

\subsection{Element Description}

\begin{marginfigure}
    \centering
    \begin{tikzpicture}
        \draw[black,thick] (0,0) -- (-60:3cm) -- (-120:3cm) -- cycle;
        \path (0,0) node[above] {$1$};
        \path (-60:3cm) node[below right] {$2$};
        \path (-120:3cm) node[below left] {$3$};
        \path (-60:1.5cm) node[above right] {$5$};
        \path (-120:1.5cm) node[above left] {$4$};
        \path (-60:3cm) -- (-120:3cm) node[midway,below] {$6$};
    \end{tikzpicture}
\end{marginfigure}

Shape Functions in barycentric coordinates \begin{align}
    N_1(\xi_1,\xi_2,\xi_3) &= \xi_1 \\
    N_2(\xi_1,\xi_2,\xi_3) &= \xi_2 \\
    N_3(\xi_1,\xi_2,\xi_3) &= \xi_3 \\
    N_4(\xi_1,\xi_2,\xi_3) &= 4 \xi_1\xi_3 \\
    N_5(\xi_1,\xi_2,\xi_3) &= 4 \xi_1\xi_2 \\
    N_6(\xi_1,\xi_2,\xi_3) &= 4 \xi_2\xi_3
\end{align}

Barycentric Interpolation Formula $P: \mathbb{B}^3 \abbild \mathbb{R}^2$ \begin{align}
    P(\xi_1,\xi_2,\xi_3) &= p_1 \xi_1 + p_2 \xi_2 + p_3 \xi_3
\end{align} mit $p_i \in \mathbb{R}^2$, $\xi_i \in [0,1]$

$\xi$-$\eta$-Transformation \begin{align}
    \xi_1 &:=  1 - \xi - \eta  \\
    \xi_2 &:= \xi\\
    \xi_3 &:=  \eta
\end{align} mit $\xi \in [0,1],\, \eta \in [0,1]$

Es gilt: \begin{align}
    T(\xi, \eta) &= \begin{bmatrix}
        1 - \xi - \eta \\
        \xi \\
        \eta \\
    \end{bmatrix} \\
    T^{-1}(\xi_1,\xi_2,\xi_3) &= \xi_1 \begin{bmatrix}
        0\\
        0\\
    \end{bmatrix} + \xi_2 \begin{bmatrix}
        1\\
        0\\
    \end{bmatrix} + \xi_3 \begin{bmatrix}
        0\\
        1\\
    \end{bmatrix}
\end{align}

\subsection{Pure Integrators}

\subsubsection{Quadrilaterial Integrator}

Characteristic points in barycentric coordinates
\begin{marginfigure}
    \centering
    \begin{tikzpicture}
        \draw[black,thick] (0,0) coordinate (ca) 
          -- (-60:3cm) coordinate (cb) 
          -- (-120:3cm) coordinate (cc) -- cycle;
        %\path (0,0) node[above] {$1$};
        %\path (-60:3cm) node[above right] {$2$};
        %\path (-120:3cm) node[above left] {$3$};
        %\path (-60:1.5cm) node[above right] {$5$};
        %\path (-120:1.5cm) node[above left] {$4$};
        %\path (-60:3cm) -- (-120:3cm) node[midway,above] {$6$};
        \draw[fill] (barycentric cs:ca=0.333,cb=0.333,cc=0.333) coordinate (cbb) circle (2pt) node[below right] {$B_C$};
        \draw[fill] (barycentric cs:ca=1.0,cb=0.0,cc=0.0) coordinate (cb1) circle (2pt) node[above] {$B_1$};
        \draw[fill] (barycentric cs:ca=0.0,cb=1.0,cc=0.0) coordinate (cb2) circle (2pt) node[above right] {$B_2$};
        \draw[fill] (barycentric cs:ca=0.0,cb=0.0,cc=1.0) coordinate (cb3) circle (2pt) node[above left] {$B_3$};
        \draw[fill] (barycentric cs:ca=0.5,cb=0.0,cc=0.5) coordinate (cb4) circle (2pt) node[above left] {$B_4$};
        \draw[fill] (barycentric cs:ca=0.5,cb=0.5,cc=0.0) coordinate (cb5) circle (2pt) node[above right] {$B_5$};
        \draw[fill] (barycentric cs:ca=0.0,cb=0.5,cc=0.5) coordinate (cb6) circle (2pt) node[below] {$B_6$};
        \draw[blue,semithick] (cb1) -- (cb4) -- (cbb) -- (cb5) -- cycle;
        \draw[blue,semithick] (cb2) -- (cb6) -- (cbb) -- (cb5) -- cycle;
        \draw[blue,semithick] (cb3) -- (cb4) -- (cbb) -- (cb6) -- cycle;
        \node at (barycentric cs:cb1=2,cb4=1,cbb=1,cb5=1) {$D_1$};
        \node at (barycentric cs:cb2=2,cb6=1,cbb=1,cb5=1) {$D_2$};
        \node at (barycentric cs:cb3=2,cb4=1,cbb=1,cb6=1) {$D_3$};
    \end{tikzpicture}
\end{marginfigure}
\begin{align}
    B_C &= \begin{bmatrix}
        \frac{1}{3} \\
        \frac{1}{3} \\
        \frac{1}{3} \\
    \end{bmatrix} \label{eqn:characteristicPoint1}\\ 
    B_1 &= \begin{bmatrix}
        1 \\
        0 \\
        0 \\
    \end{bmatrix}& B_2 &= \begin{bmatrix}
        0 \\
        1 \\
        0 \\
    \end{bmatrix}& B_3 &= \begin{bmatrix}
        0 \\
        0 \\
        1 \\
    \end{bmatrix} \label{eqn:characteristicPoint2}\\
    B_4 &= \begin{bmatrix}
        0.5 \\
        0 \\
        0.5 \\
    \end{bmatrix}& 
    B_5 &= \begin{bmatrix}
        0.5 \\
        0.5 \\
        0 \\
    \end{bmatrix}& 
    B_6 &= \begin{bmatrix}
        0 \\
        0.5 \\
        0.5 \\
    \end{bmatrix} \label{eqn:characteristicPoint3}
\end{align}

Domain of a Simplex $\boldsymbol{\Delta}$ can be decomposed into three disjunct subdomains: \begin{equation}
    \boldsymbol{\Delta} = D_1 \cup D_2 \cup D_3
\end{equation}
Therefore the double-Integral \begin{equation}
    \iint_{\boldsymbol{\Delta}} F \diff \boldsymbol{\Delta} = \iint_{D_1} F \diff D_1 + \iint_{D_2} F \diff D_2 + \iint_{D_3} F \diff D_3
\end{equation}

Mapping functions from the $[-1,1] \times [-1,1]$ $X$-$Y$-Unit Square \begin{align}
    g_{1}(X) &= \frac{X}{2} + \frac{1}{2} & g_2(X) &= -\frac{X}{2} + \frac{1}{2} \\
    \pardiff{g_1}{X} &= \frac{1}{2} & \pardiff{g_2}{X} &= -\frac{1}{2} \\
    g_{1}(Y) &= \frac{Y}{2} + \frac{1}{2} & g_2(Y) &= -\frac{Y}{2} + \frac{1}{2} \\
    \pardiff{g_1}{Y} &= \frac{1}{2} & \pardiff{g_2}{Y} &= -\frac{1}{2} \\
    G_1(X,Y) &= g_1(X)g_1(Y) & G_2(X,Y) &= g_1(X)g_2(Y) \\
    G_3(X,Y) &= g_2(X)g_1(Y) & G_4(X,Y) &= g_2(X)g_2(Y)
\end{align} to barycentric coordinates of the $D_1,\, D_2,\, D_3$ Quadrilaterials \begin{align}
    B_{D_1}(X,Y) &= B_1 \cdot G_1(X,Y) + B_5 \cdot G_2(X,Y) + B_4 \cdot G_3(X,Y) + B_C \cdot G_4(X,Y) \label{eqn:DomainTrans1} \\
    B_{D_2}(X,Y) &= B_2 \cdot G_1(X,Y) + B_6 \cdot G_2(X,Y) + B_5 \cdot G_3(X,Y) + B_C \cdot G_4(X,Y) \label{eqn:DomainTrans2} \\
    B_{D_3}(X,Y) &= B_3 \cdot G_1(X,Y) + B_4 \cdot G_2(X,Y) + B_6 \cdot G_3(X,Y) + B_C \cdot G_4(X,Y) \label{eqn:DomainTrans3}
\end{align}

\paragraph{Numerical Integration Scheme}

The Integration is done on the Square $[-1,1] \times [-1, 1]$, which allows for Gaussian Integration to be used: \begin{equation}
    \iint_{[-1,1] \times [-1, 1]} F(X,Y) \diff (X,Y) \approx \sum_i \sum_j F(X_i,X_j) w_i w_j 
\end{equation}
The Gauss-Points $(X_i, X_j)$ and their weights $w_i,w_j$ on the Square can be deduced from the one dimensional Gaussian Integration \begin{equation}
    \int_{-1}^1 H(X) \diff X \approx \sum_i H(X_i) w_i
\end{equation}

The Weights and Points of the 1D Gauss-Legendre Integration are given as: \begin{align*}
    n &= 1 & X &= 0 & w &= 2 \\
    n &= 2 & X &= \sqrt{\frac{1}{3}} & w &= 1 \\
    & & X &= -\sqrt{\frac{1}{3}} & w &= 1 \\
    n &= 3 & X &= \sqrt{\frac{3}{5}} & w &= \frac{5}{9} \\
    & & X &= 0 & w &= \frac{8}{9} \\
    & & X &= -\sqrt{\frac{3}{5}} & w &= \frac{5}{9} \\
\end{align*}

\paragraph{Integral transformation} from the 3 Domains into any simplex.

\begin{Figure}
    \centering
    \begin{tikzpicture}
        \begin{scope}
          \node at (2.5,-0.5) {Euclidean Space $\mathbb{R}^2$};
          \draw[-latex] (0,0) -- (1,0) node[below] {$x$};
          \draw[-latex] (0,0) -- (0,1) node[left] {$y$};
          \draw[black,thick] (3.5,1) coordinate (ca) 
          -- (3,4) coordinate (cb) 
          -- (1,1) coordinate (cc) -- cycle;
          %\path (0,0) node[above] {$1$};
          %\path (-60:3cm) node[above right] {$2$};
          %\path (-120:3cm) node[above left] {$3$};
          %\path (-60:1.5cm) node[above right] {$5$};
          %\path (-120:1.5cm) node[above left] {$4$};
          %\path (-60:3cm) -- (-120:3cm) node[midway,above] {$6$};
          %\draw[fill] (barycentric cs:ca=0.333,cb=0.333,cc=0.333) coordinate (cbb) circle (2pt) node[below right] {$B_C$};
          \draw[fill] (barycentric cs:ca=0.333,cb=0.333,cc=0.333) coordinate (cbb) circle (2pt); %node[below right] {$(x_B,y_B)$};
          \draw[fill] (barycentric cs:ca=1.0,cb=0.0,cc=0.0) coordinate (cb1) circle (2pt) node[below]             {$(x_1,y_1)$};
          \draw[fill] (barycentric cs:ca=0.0,cb=1.0,cc=0.0) coordinate (cb2) circle (2pt) node[above]             {$(x_2,y_2)$};
          \draw[fill] (barycentric cs:ca=0.0,cb=0.0,cc=1.0) coordinate (cb3) circle (2pt) node[below]             {$(x_3,y_3)$};
          \draw[fill] (barycentric cs:ca=0.5,cb=0.0,cc=0.5) coordinate (cb4) circle (2pt); %node[below]             {$(x_4,y_4)$};
          \draw[fill] (barycentric cs:ca=0.5,cb=0.5,cc=0.0) coordinate (cb5) circle (2pt); %node[above right]       {$(x_5,y_5)$};
          \draw[fill] (barycentric cs:ca=0.0,cb=0.5,cc=0.5) coordinate (cb6) circle (2pt); %node[above left]        {$(x_6,y_6)$};
          \draw[blue,semithick] (cb1) -- (cb4) -- (cbb) -- (cb5) -- cycle;
          \draw[blue,semithick] (cb2) -- (cb6) -- (cbb) -- (cb5) -- cycle;
          \draw[blue,semithick] (cb3) -- (cb4) -- (cbb) -- (cb6) -- cycle;
          %\node at (barycentric cs:cb1=2,cb4=1,cbb=1,cb5=1) {$D_1$};
          %\node at (barycentric cs:cb2=2,cb6=1,cbb=1,cb5=1) {$D_2$};
          %\node at (barycentric cs:cb3=2,cb4=1,cbb=1,cb6=1) {$D_3$};
        \end{scope}
        \begin{scope}[shift={(3.5,5)}] 
            \node at (3,0.5) {Barycentric Space $\mathbb{B}^3$};
            \draw[black,thick] (3,4) coordinate (ca) 
              -- +(-60:3cm) coordinate (cb) 
              -- +(-120:3cm) coordinate (cc) -- cycle;
            %\path (0,0) node[above] {$1$};
            %\path (-60:3cm) node[above right] {$2$};
            %\path (-120:3cm) node[above left] {$3$};
            %\path (-60:1.5cm) node[above right] {$5$};
            %\path (-120:1.5cm) node[above left] {$4$};
            %\path (-60:3cm) -- (-120:3cm) node[midway,above] {$6$};
            \draw[fill] (barycentric cs:ca=0.333,cb=0.333,cc=0.333) coordinate (cbb) circle (2pt) node[below right] {$B_C$};
            \draw[fill] (barycentric cs:ca=1.0,cb=0.0,cc=0.0) coordinate (cb1) circle (2pt) node[above] {$B_1$};
            \draw[fill] (barycentric cs:ca=0.0,cb=1.0,cc=0.0) coordinate (cb2) circle (2pt) node[above right] {$B_2$};
            \draw[fill] (barycentric cs:ca=0.0,cb=0.0,cc=1.0) coordinate (cb3) circle (2pt) node[above left] {$B_3$};
            \draw[fill] (barycentric cs:ca=0.5,cb=0.0,cc=0.5) coordinate (cb4) circle (2pt) node[above left] {$B_4$};
            \draw[fill] (barycentric cs:ca=0.5,cb=0.5,cc=0.0) coordinate (cb5) circle (2pt) node[above right] {$B_5$};
            \draw[fill] (barycentric cs:ca=0.0,cb=0.5,cc=0.5) coordinate (cb6) circle (2pt) node[below] {$B_6$};
            \draw[blue,semithick] (cb1) -- (cb4) -- (cbb) -- (cb5) -- cycle;
            \draw[blue,semithick] (cb2) -- (cb6) -- (cbb) -- (cb5) -- cycle;
            \draw[blue,semithick] (cb3) -- (cb4) -- (cbb) -- (cb6) -- cycle;
            %
            %\draw[fill,red] (barycentric cs:ca=0.419,cb=0.291,cc=0.291) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.556,cb=0.078,cc=0.367) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.556,cb=0.367,cc=0.078) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.804,cb=0.098,cc=0.098) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.291,cb=0.419,cc=0.291) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.367,cb=0.556,cc=0.078) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.078,cb=0.556,cc=0.367) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.098,cb=0.804,cc=0.098) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.291,cb=0.291,cc=0.419) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.078,cb=0.367,cc=0.556) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.367,cb=0.078,cc=0.556) coordinate (cb1) circle (2pt);
            %\draw[fill,red] (barycentric cs:ca=0.098,cb=0.098,cc=0.804) coordinate (cb1) circle (2pt);
        \end{scope}
        \begin{scope}[shift={(10,0)}] 
            \node at (0,-2) {Integration Space ${[-1,1]}^2$};
            \begin{scope}[shift={(-1.75,0)}]
                \draw[-latex] (-1.5,0) -- (1.5,0) node[below] {$X$};
                \draw[-latex] (0,-1.5) -- (0,1.5) node[left]  {$Y$};
                \draw[blue,semithick] (-1,-1) node[below left] {$B_1$}
                  -- (-1,1) node[above left] {$B_5$}
                  -- (1,1) node[above right] {$B_C$}
                  -- (1,-1) node[below right] {$B_4$} -- cycle;
            \end{scope}
            \begin{scope}[shift={(1.75,0)}]
                \draw[-latex] (-1.5,0) -- (1.5,0) node[below] {$X$};
                \draw[-latex] (0,-1.5) -- (0,1.5) node[left]  {$Y$};
                \draw[blue,semithick] (-1,-1) node[below left] {$B_2$}
                  -- (-1,1) node[above left] {$B_6$}
                  -- (1,1) node[above right] {$B_C$}
                  -- (1,-1) node[below right] {$B_5$} -- cycle;
            \end{scope}
            \begin{scope}[shift={(0,3.5)}]
                \draw[-latex] (-1.5,0) -- (1.5,0) node[below] {$X$};
                \draw[-latex] (0,-1.5) -- (0,1.5) node[left]  {$Y$};
                \draw[blue,semithick] (-1,-1) node[below left] {$B_3$}
                  -- (-1,1) node[above left] {$B_4$}
                  -- (1,1)  node[above right] {$B_C$}
                  -- (1,-1) node[below right] {$B_6$} -- cycle;
            \end{scope}
        \end{scope}
        \draw[<-] (4,5) -- (4.5,6) node[midway,above left] {$T_{C1}$};
        \draw[<-] (8.5,6) -- (9,5) node[midway,above right] {$T_{C2}$};
        \draw[<-] (4,0) -- (6,-0.5) node[midway,below] {$T_3$};
    \end{tikzpicture}
\end{Figure}

Let $S$ denote a Matrix of the coordinates of the vertices of the simplex in the following form\begin{equation}
    S = \begin{bmatrix}
        x_1 & x_2 & x_3 \\
        y_1 & y_2 & y_3 \\
    \end{bmatrix}
\end{equation}

The Coordinates $C_{i}$ of all characteristic points in Equations \eqref{eqn:characteristicPoint1},\eqref{eqn:characteristicPoint2} and \eqref{eqn:characteristicPoint3} inside the simplex can be expressed in the following form \begin{align}
    C_{C} &= S \cdot B_{C} \label{eqn:Trans1}\\
    C_{i} &= S \cdot B_{i} \quad \forall i \in 1,2,\ldots,6 \label{eqn:Trans2}
\end{align}.

The transformation from points in the Integration Domain to the points in the barycentric given in \eqref{eqn:DomainTrans1},\eqref{eqn:DomainTrans2} and \eqref{eqn:DomainTrans3} can be expressed as \begin{align}
    B_{D_1}(X,Y) &=\begin{bmatrix}
        B_1 & B_5 & B_4 & B_C \\ 
    \end{bmatrix} \begin{bmatrix}
        G_1(X,Y) \\
        G_2(X,Y) \\
        G_3(X,Y) \\
        G_4(X,Y) \\
    \end{bmatrix} \\
    B_{D_2}(X,Y) &=\begin{bmatrix}
        B_2 & B_6 & B_5 & B_C \\ 
    \end{bmatrix} \begin{bmatrix}
        G_1(X,Y) \\
        G_2(X,Y) \\
        G_3(X,Y) \\
        G_4(X,Y) \\
    \end{bmatrix} \\
    B_{D_3}(X,Y) &=\begin{bmatrix}
        B_3 & B_4 & B_6 & B_C \\ 
    \end{bmatrix} \begin{bmatrix}
        G_1(X,Y) \\
        G_2(X,Y) \\
        G_3(X,Y) \\
        G_4(X,Y) \\
    \end{bmatrix}
\end{align} 

With the Relationship given in \eqref{eqn:Trans1} and \eqref{eqn:Trans2} one can rewrite this as \begin{align}
    C_{D_1}(X,Y) &= S \begin{bmatrix}
        B_1 & B_5 & B_4 & B_C \\ 
    \end{bmatrix} \begin{bmatrix}
        G_1(X,Y) \\
        G_2(X,Y) \\
        G_3(X,Y) \\
        G_4(X,Y) \\
    \end{bmatrix} \\
    C_{D_2}(X,Y) &= S \begin{bmatrix}
        B_2 & B_6 & B_5 & B_C \\ 
    \end{bmatrix} \begin{bmatrix}
        G_1(X,Y) \\
        G_2(X,Y) \\
        G_3(X,Y) \\
        G_4(X,Y) \\
    \end{bmatrix} \\
    C_{D_3}(X,Y) &= S \begin{bmatrix}
        B_3 & B_4 & B_6 & B_C \\ 
    \end{bmatrix} \begin{bmatrix}
        G_1(X,Y) \\
        G_2(X,Y) \\
        G_3(X,Y) \\
        G_4(X,Y) \\
    \end{bmatrix}
\end{align}

With the Jacobi Matrix of any particular Domain being \begin{equation}
    J(C_{D_i}) = \begin{bmatrix}
        \pardiff{C_{D_i}}{X} & \pardiff{C_{D_i}}{Y} \\ 
    \end{bmatrix} = \begin{bmatrix}
        C_i & C_j & C_k & C_C \\ 
    \end{bmatrix}\cdot \begin{bmatrix}
        \pardiff{G_1}{X} & \pardiff{G_1}{Y} \\  
        \pardiff{G_2}{X} & \pardiff{G_2}{Y} \\
        \pardiff{G_3}{X} & \pardiff{G_3}{Y} \\
        \pardiff{G_4}{X} &\pardiff{G_4}{Y} \\
    \end{bmatrix}
\end{equation}

\paragraph{Gauss Point Distribution} for the three Orders of Integration used.

\begin{Figure}
    \centering
    \begin{tikzpicture}
        \begin{scope}[shift={(0,0)}] 
            \node at (3,0.5) {Gauss Points $n=1$};
            \draw[black,thick] (3,4) coordinate (ca) 
              -- +(-60:3cm) coordinate (cb) 
              -- +(-120:3cm) coordinate (cc) -- cycle;
            %\path (0,0) node[above] {$1$};
            %\path (-60:3cm) node[above right] {$2$};
            %\path (-120:3cm) node[above left] {$3$};
            %\path (-60:1.5cm) node[above right] {$5$};
            %\path (-120:1.5cm) node[above left] {$4$};
            %\path (-60:3cm) -- (-120:3cm) node[midway,above] {$6$};
            %\draw[blue,semithick] (cb1) -- (cb4) -- (cbb) -- (cb5) -- cycle;
            %\draw[blue,semithick] (cb2) -- (cb6) -- (cbb) -- (cb5) -- cycle;
            %\draw[blue,semithick] (cb3) -- (cb4) -- (cbb) -- (cb6) -- cycle;
            %
            \draw[fill,red] (barycentric cs:ca=0.583,cb=0.208,cc=0.208) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.208,cb=0.583,cc=0.208) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.208,cb=0.208,cc=0.583) coordinate (cb1) circle (2pt);
        \end{scope}
        \begin{scope}[shift={(3.5,0)}] 
            \node at (3,0.5) {Gauss Points $n=2$};
            \draw[black,thick] (3,4) coordinate (ca) 
              -- +(-60:3cm) coordinate (cb) 
              -- +(-120:3cm) coordinate (cc) -- cycle;
            %\path (0,0) node[above] {$1$};
            %\path (-60:3cm) node[above right] {$2$};
            %\path (-120:3cm) node[above left] {$3$};
            %\path (-60:1.5cm) node[above right] {$5$};
            %\path (-120:1.5cm) node[above left] {$4$};
            %\path (-60:3cm) -- (-120:3cm) node[midway,above] {$6$};
            %\draw[blue,semithick] (cb1) -- (cb4) -- (cbb) -- (cb5) -- cycle;
            %\draw[blue,semithick] (cb2) -- (cb6) -- (cbb) -- (cb5) -- cycle;
            %\draw[blue,semithick] (cb3) -- (cb4) -- (cbb) -- (cb6) -- cycle;
            %
            \draw[fill,red] (barycentric cs:ca=0.419,cb=0.291,cc=0.291) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.556,cb=0.078,cc=0.367) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.556,cb=0.367,cc=0.078) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.804,cb=0.098,cc=0.098) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.291,cb=0.419,cc=0.291) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.367,cb=0.556,cc=0.078) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.078,cb=0.556,cc=0.367) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.098,cb=0.804,cc=0.098) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.291,cb=0.291,cc=0.419) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.078,cb=0.367,cc=0.556) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.367,cb=0.078,cc=0.556) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.098,cb=0.098,cc=0.804) coordinate (cb1) circle (2pt);
        \end{scope}
        \begin{scope}[shift={(7,0)}] 
            \node at (3,0.5) {Gauss Points $n=3$};
            \draw[black,thick] (3,4) coordinate (ca) 
              -- +(-60:3cm) coordinate (cb) 
              -- +(-120:3cm) coordinate (cc) -- cycle;
            %\path (0,0) node[above] {$1$};
            %\path (-60:3cm) node[above right] {$2$};
            %\path (-120:3cm) node[above left] {$3$};
            %\path (-60:1.5cm) node[above right] {$5$};
            %\path (-120:1.5cm) node[above left] {$4$};
            %\path (-60:3cm) -- (-120:3cm) node[midway,above] {$6$};
            %\draw[blue,semithick] (cb1) -- (cb4) -- (cbb) -- (cb5) -- cycle;
            %\draw[blue,semithick] (cb2) -- (cb6) -- (cbb) -- (cb5) -- cycle;
            %\draw[blue,semithick] (cb3) -- (cb4) -- (cbb) -- (cb6) -- cycle;
            %
            \draw[fill,red] (barycentric cs:ca=0.375,cb=0.312,cc=0.312) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.454,cb=0.176,cc=0.370) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.533,cb=0.040,cc=0.427) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.454,cb=0.370,cc=0.176) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.583,cb=0.208,cc=0.208) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.712,cb=0.047,cc=0.241) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.533,cb=0.427,cc=0.040) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.712,cb=0.241,cc=0.047) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.892,cb=0.054,cc=0.054) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.312,cb=0.375,cc=0.312) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.370,cb=0.454,cc=0.176) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.427,cb=0.533,cc=0.040) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.176,cb=0.454,cc=0.370) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.208,cb=0.583,cc=0.208) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.241,cb=0.712,cc=0.047) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.040,cb=0.533,cc=0.427) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.047,cb=0.712,cc=0.241) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.054,cb=0.892,cc=0.054) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.312,cb=0.312,cc=0.375) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.176,cb=0.370,cc=0.454) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.040,cb=0.427,cc=0.533) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.370,cb=0.176,cc=0.454) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.208,cb=0.208,cc=0.583) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.047,cb=0.241,cc=0.712) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.427,cb=0.040,cc=0.533) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.241,cb=0.047,cc=0.712) coordinate (cb1) circle (2pt);
            \draw[fill,red] (barycentric cs:ca=0.054,cb=0.054,cc=0.892) coordinate (cb1) circle (2pt);
        \end{scope}
    \end{tikzpicture}
\end{Figure}

\subsubsection{Sphere Integrator}

\subsubsection{Other Quadrature Formulas}

\pagebreak

\subsection{Subdivision Integrator}

Because any triangle can be decomposed into 4 similar triangles, the subdivision algorithm turns out to be quite practical in implementation.

The Integral over a parent Simplex $\boldsymbol{\Delta}_p$, can be expressed as an Integral over 4 Child Simpleces $\boldsymbol{\Delta}_i$: 
\begin{marginfigure}
    \centering
    \begin{tikzpicture}
        \draw[black,thick] (0,0) coordinate (ca) 
          -- (-60:3cm) coordinate (cb) 
          -- (-120:3cm) coordinate (cc) -- cycle;
        %\path (0,0) node[above] {$1$};
        %\path (-60:3cm) node[above right] {$2$};
        %\path (-120:3cm) node[above left] {$3$};
        %\path (-60:1.5cm) node[above right] {$5$};
        %\path (-120:1.5cm) node[above left] {$4$};
        %\path (-60:3cm) -- (-120:3cm) node[midway,above] {$6$};
        %\draw[fill] (barycentric cs:ca=0.333,cb=0.333,cc=0.333) coordinate (cbb) circle (2pt) node[below right] {$B_C$};
        \draw[fill] (barycentric cs:ca=1.0,cb=0.0,cc=0.0) coordinate (cb1) circle (2pt) node[above] {$B_1$};
        \draw[fill] (barycentric cs:ca=0.0,cb=1.0,cc=0.0) coordinate (cb2) circle (2pt) node[above right] {$B_2$};
        \draw[fill] (barycentric cs:ca=0.0,cb=0.0,cc=1.0) coordinate (cb3) circle (2pt) node[above left] {$B_3$};
        \draw[fill] (barycentric cs:ca=0.5,cb=0.0,cc=0.5) coordinate (cb4) circle (2pt) node[above left] {$B_4$};
        \draw[fill] (barycentric cs:ca=0.5,cb=0.5,cc=0.0) coordinate (cb5) circle (2pt) node[above right] {$B_5$};
        \draw[fill] (barycentric cs:ca=0.0,cb=0.5,cc=0.5) coordinate (cb6) circle (2pt) node[below] {$B_6$};
        \draw[blue,semithick] (cb1) -- (cb5) -- (cb4) -- cycle;
        \draw[blue,semithick] (cb2) -- (cb6) -- (cb5) -- cycle;
        \draw[blue,semithick] (cb3) -- (cb4) -- (cb6) -- cycle;
        \draw[blue,semithick] (cb4) -- (cb5) -- (cb6) -- cycle;
        \node at (barycentric cs:cb1=1,cb5=1,cb4=1) {$\boldsymbol{\Delta}_1$};
        \node at (barycentric cs:cb2=1,cb6=1,cb5=1) {$\boldsymbol{\Delta}_2$};
        \node at (barycentric cs:cb3=1,cb4=1,cb6=1) {$\boldsymbol{\Delta}_3$};
        \node at (barycentric cs:cb4=1,cb5=1,cb6=1) {$\boldsymbol{\Delta}_4$};
    \end{tikzpicture}
\end{marginfigure}
\begin{align}
    \iint_{\boldsymbol{\Delta}_p} F \diff\boldsymbol{\Delta}_p &= \iint_{\boldsymbol{\Delta}_1} F \diff\boldsymbol{\Delta}_1 + \iint_{\boldsymbol{\Delta}_2} F \diff\boldsymbol{\Delta}_2 +\iint_{\boldsymbol{\Delta}_3} F \diff\boldsymbol{\Delta}_3 + \iint_{\boldsymbol{\Delta}_4} F \diff\boldsymbol{\Delta}_4
\end{align}

The Coordinates of a Child Simplex $\simplex_i$ can be expressed in local-barycentric coordinates $\xi_{i,1}',\, \xi_{i,2}',\, \xi_{i,3}'$

The corresponding Transformation from the local coordinate System into the global is given by \begin{align}
   T_{lg}(\xi_{i,1}', \xi_{i,2}', \xi_{i,3}') &= B_{i,1}\xi_{i,1}' + B_{i,2}\xi_{i,2}' + B_{i,3} \xi_{i,3}'
\end{align} where $B_{i,j}$ are the coordinates of the Verteces of the Child Simplex $\simplex_i$.

This can be done recursively, to get a desired accuracy.
%
%The Vertices of e.g. the $[B_3,B_4,B_6]$ Child Simplex can be calculated by \begin{align}
%    \begin{bmatrix}
%        B_1' & B_2' & B_3' \\ 
%    \end{bmatrix} &= \begin{bmatrix}
%        B_3 & B_4 & B_6 \\ 
%    \end{bmatrix} \begin{bmatrix}
%        B_1 & B_2 & B_3 \\ 
%    \end{bmatrix}
%\end{align}



\subsection{Simplex Subdivision}

A Criterion for adaptive integration \begin{align}
    Q &= \iint_{\simplex} F \diff \simplex \\
    \varepsilon &= \Bigl\vert Q - \iint_{\simplex_p} F \diff \simplex_p \Bigr\vert
\end{align}

The Coordinates of the Verteces of the 4 Child Simplizes $\simplex_i$ can be calculated with $S$ by \begin{align}
    S_{\simplex,1} &= S \cdot B_{\simplex,1} = S \cdot \begin{bmatrix}
        B_1 & B_5 & B_4 \\
    \end{bmatrix} = S \cdot \begin{bmatrix}
        1 & 0.5 & 0.5 \\
        0 & 0.5 & 0 \\
        0 & 0 & 0.5 \\
    \end{bmatrix} \\
    S_{\simplex,2} &= S \cdot B_{\simplex,2} = S \cdot \begin{bmatrix}
        B_2 & B_6 & B_5 \\
    \end{bmatrix} = S \cdot \begin{bmatrix}
        0 & 0   & 0.5 \\
        1 & 0.5 & 0.5 \\
        0 & 0.5 & 0   \\
    \end{bmatrix} \\
    S_{\simplex,3} &= S \cdot B_{\simplex,3} = S \cdot \begin{bmatrix}
        B_3 & B_4 & B_6 \\
    \end{bmatrix} = S \cdot \begin{bmatrix}
        0 & 0.5 & 0   \\
        0 & 0   & 0.5 \\
        1 & 0.5 & 0.5 \\
    \end{bmatrix} \\
    S_{\simplex,4} &= S \cdot B_{\simplex,4} = S \cdot \begin{bmatrix}
        B_4 & B_5 & B_6 \\
    \end{bmatrix} = S \cdot \begin{bmatrix}
        0.5 & 0.5 & 0   \\
        0   & 0.5 & 0.5 \\
        0.5 & 0   & 0.5 \\
    \end{bmatrix}
\end{align}

Coordinates of any Grandchild-Simplizes can be calculated by chaining $B_{\simplex,i}$ Transformations

\begin{Figure}
    \centering
    \begin{tikzpicture}
        \draw[black,thick] (3,4) coordinate (ca) 
              -- +(-60:3cm) coordinate (cb) 
              -- +(-120:3cm) coordinate (cc) -- cycle;
              %\draw[fill,blue] (barycentric cs:ca=0.583,cb=0.208,cc=0.208) coordinate (cb1) circle (2pt);
              %\draw[fill,blue] (barycentric cs:ca=0.208,cb=0.583,cc=0.208) coordinate (cb1) circle (2pt);
              %\draw[fill,blue] (barycentric cs:ca=0.208,cb=0.208,cc=0.583) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.792,cb=0.104,cc=0.104) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.604,cb=0.292,cc=0.104) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.604,cb=0.104,cc=0.292) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.104,cb=0.792,cc=0.104) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.104,cb=0.604,cc=0.292) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.292,cb=0.604,cc=0.104) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.104,cb=0.104,cc=0.792) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.292,cb=0.104,cc=0.604) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.104,cb=0.292,cc=0.604) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.396,cb=0.208,cc=0.396) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.396,cb=0.396,cc=0.208) coordinate (cb1) circle (2pt);
              \draw[fill,red] (barycentric cs:ca=0.208,cb=0.396,cc=0.396) coordinate (cb1) circle (2pt);
    \end{tikzpicture}
\end{Figure}

\pagebreak

\section{Simplex Integration in $n=3$}

\begin{Figure}
    \centering
    \begin{tikzpicture}
        \begin{scope}[engineering axonometry]
            \begin{scope}[scale=2]
                \coordinate (b1) at ({sqrt(8/9)},0,0);
                \coordinate (b2) at ({-sqrt(2/9)},{sqrt(2/3)},0);
                \coordinate (b3) at ({-sqrt(2/9)},{-sqrt(2/3)},0);
                \coordinate (b4) at (0,0,4/3);
            \end{scope}
            \draw (b1) -- (b2);
            \draw (b2) -- (b3);
            \draw (b3) -- (b1);
            \draw (b1) -- (b4);
            \draw (b2) -- (b4);
            \draw (b3) -- (b4);
            \node[below] at (b1) {$B_1$};
            \node[right] at (b2) {$B_2$};
            \node[left]  at (b3) {$B_3$};
            \node[above] at (b4) {$B_4$};
            %% Centroid
            \draw[fill] (barycentric cs:b1=0.25,b2=0.25,b3=0.25,b4=0.25) coordinate (bc) circle (2pt);% node[below right] {$B_C$};
            %% Center of Planes
            \draw[fill] (barycentric cs:b1=0.33,b2=0.33,b3=0.33,b4=0.00) coordinate (ba4) circle (2pt);% node[below right] {$B_1$};
            \draw[fill] (barycentric cs:b1=0.00,b2=0.33,b3=0.33,b4=0.33) coordinate (ba1) circle (2pt);% node[below right] {$B_2$};
            \draw[fill] (barycentric cs:b1=0.33,b2=0.00,b3=0.33,b4=0.33) coordinate (ba2) circle (2pt);% node[below right] {$B_3$};
            \draw[fill] (barycentric cs:b1=0.33,b2=0.33,b3=0.00,b4=0.33) coordinate (ba3) circle (2pt);% node[below right] {$B_4$};
            %% Center of Edges
            \draw[fill] (barycentric cs:b1=0.50,b2=0.50,b3=0.00,b4=0.00) coordinate (be12) circle (2pt);% node[below right] {$B_1$};
            \draw[fill] (barycentric cs:b1=0.00,b2=0.50,b3=0.50,b4=0.00) coordinate (be23) circle (2pt);% node[below right] {$B_2$};
            \draw[fill] (barycentric cs:b1=0.00,b2=0.00,b3=0.50,b4=0.50) coordinate (be34) circle (2pt);% node[below right] {$B_3$};
            \draw[fill] (barycentric cs:b1=0.50,b2=0.00,b3=0.50,b4=0.00) coordinate (be13) circle (2pt);
            \draw[fill] (barycentric cs:b1=0.50,b2=0.00,b3=0.00,b4=0.50) coordinate (be14) circle (2pt);% node[below right] {$B_3$};
            \draw[fill] (barycentric cs:b1=0.00,b2=0.50,b3=0.00,b4=0.50) coordinate (be24) circle (2pt);
            %% Domains
            \draw[semithick,blue,line join=round] (b1) -- (be12) -- (ba3) -- (bc) -- (ba2) -- (be13) --cycle;
            \draw[semithick,blue,line join=round] (be12) -- (ba4) -- (be13);
            \draw[semithick,blue,line join=round] (ba3) -- (be14) -- (ba2);
            \draw[semithick,blue,line join=round] (b1) -- (be14);
            \draw[semithick,blue,line join=round] (ba4) -- (bc);
            %% Domains
            \draw[semithick,blue,line join=round] (b2) -- (be12) -- (ba3) -- (bc) -- (ba1) -- (be23) --cycle;
            \draw[semithick,blue,line join=round] (be12) -- (ba4) -- (be13);
            \draw[semithick,blue,line join=round] (b2) -- (be24) -- (ba3);
            \draw[semithick,blue,line join=round] (be23) -- (ba4);
            \draw[semithick,blue,line join=round] (ba4) -- (bc);
            %% Domains
            \draw[semithick,blue,line join=round] (ba2) -- (be34) -- (ba1) -- (be24) -- (b4) -- (be14) --cycle;
            %%
            \draw[semithick,blue,line join=round] (b4) -- (be34) -- (b3) -- (be13);
            \draw[semithick,blue,line join=round] (b3) -- (be23);
        \end{scope}
        \begin{scope}[shift={(5.0,0.0)},engineering axonometry]
            \begin{scope}[scale=2]
                \coordinate (b1) at ({sqrt(8/9)},0,0);
                \coordinate (b2) at ({-sqrt(2/9)},{sqrt(2/3)},0);
                \coordinate (b3) at ({-sqrt(2/9)},{-sqrt(2/3)},0);
                \coordinate (b4) at (0,0,4/3);
            \end{scope}
            \draw (b1) -- (b2);
            \draw (b2) -- (b3);
            \draw (b3) -- (b1);
            \draw (b1) -- (b4);
            \draw (b2) -- (b4);
            \draw (b3) -- (b4);
            \node[below] at (b1) {$B_1$};
            \node[right] at (b2) {$B_2$};
            \node[left]  at (b3) {$B_3$};
            \node[above] at (b4) {$B_4$};
            %% Centroid
            %\draw[fill] (barycentric cs:b1=0.25,b2=0.25,b3=0.25,b4=0.25) coordinate (bc) circle (2pt);% node[below right] {$B_C$};
            %% Center of Planes
            %\draw[fill] (barycentric cs:b1=0.33,b2=0.33,b3=0.33,b4=0.00) coordinate (ba4) circle (2pt);% node[below right] {$B_1$};
            %\draw[fill] (barycentric cs:b1=0.00,b2=0.33,b3=0.33,b4=0.33) coordinate (ba1) circle (2pt);% node[below right] {$B_2$};
            %\draw[fill] (barycentric cs:b1=0.33,b2=0.00,b3=0.33,b4=0.33) coordinate (ba2) circle (2pt);% node[below right] {$B_3$};
            %\draw[fill] (barycentric cs:b1=0.33,b2=0.33,b3=0.00,b4=0.33) coordinate (ba3) circle (2pt);% node[below right] {$B_4$};
            %% Center of Edges
            \draw[fill] (barycentric cs:b1=0.50,b2=0.50,b3=0.00,b4=0.00) coordinate (be12) circle (2pt);% node[below right] {$B_1$};
            \draw[fill] (barycentric cs:b1=0.00,b2=0.50,b3=0.50,b4=0.00) coordinate (be23) circle (2pt);% node[below right] {$B_2$};
            \draw[fill] (barycentric cs:b1=0.00,b2=0.00,b3=0.50,b4=0.50) coordinate (be34) circle (2pt);% node[below right] {$B_3$};
            \draw[fill] (barycentric cs:b1=0.50,b2=0.00,b3=0.50,b4=0.00) coordinate (be13) circle (2pt);
            \draw[fill] (barycentric cs:b1=0.50,b2=0.00,b3=0.00,b4=0.50) coordinate (be14) circle (2pt);% node[below right] {$B_3$};
            \draw[fill] (barycentric cs:b1=0.00,b2=0.50,b3=0.00,b4=0.50) coordinate (be24) circle (2pt);
            %% Domains
            \newcommand{\drawsimplex}[4]{
                \draw[semithick,blue,line join=round] (#1) -- (#2);
                \draw[semithick,blue,line join=round] (#1) -- (#3);
                \draw[semithick,blue,line join=round] (#1) -- (#4);
                \draw[semithick,blue,line join=round] (#2) -- (#3);
                \draw[semithick,blue,line join=round] (#2) -- (#4);
                \draw[semithick,blue,line join=round] (#3) -- (#4);
            }
            \drawsimplex{b1}{be13}{be12}{be14}
            \drawsimplex{b2}{be12}{be23}{be24}
            \drawsimplex{b3}{be13}{be23}{be34}
            \drawsimplex{b4}{be24}{be34}{be14}
            \draw[semithick,blue,line join=round] (be13) -- (be24);
        \end{scope}
    \end{tikzpicture}
\end{Figure}


\end{document}